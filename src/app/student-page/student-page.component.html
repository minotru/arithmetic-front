<header class="header" fxFlex="nogrow" fxLayout="row" fxLayoutAlign="space-between center">
  <span class="header-text">Ментальная арифметика</span>
  <span>
    <span *ngIf="userService.isAuthorized()">
      <span class="header-text">{{userService.fullUserName}}</span>
      &nbsp;|&nbsp;
      <span class="logout-link">Выйти</span>
    </span>
  </span>
</header>
<main class="main-section" fxLayout="row" fxLayoutAlign="center" fxLayoutGap="1em">
  <section class="section" [class.not-in-focus]="appState !== 'config'">
    <header>
      <h1 class="section-header-text">ТЕМЫ</h1>
    </header>
    <div class="topics" fxLayout="row" fxLayoutGap="1em" fxLayoutAlign="start start">
      <div
        *ngFor="let topic of topics"
        class="topic"
        fxLayout="column"
      >
         <div
           class="topic-name"
           [class.selected]="topic.name === configForm.value['topic']"
          >
            {{topic.caption}}
          </div>
         <div class="levels">
          <div
            *ngFor="let level of topic.levels"
            class="level"
            (click)="selectLevel(topic.name, level);"
            [class.selected]=
              "topic.name === configForm.value['topic'] 
              && level === configForm.value['level']"
          >  
            {{level}}
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section task-section" *ngIf="appState !== 'config'" fxLayout="column"> 
    <header class="section-header">
      <h1 class="section-header-text">ПРИМЕР</h1>
    </header>
    <div class="section-content" fxLayout="column" fxLayoutAlign="space-between center" style="height: 100%;">
      <!-- <span *ngIf="appState === 'enter_answer'">Введите ответ</span> -->
      <div class="task" *ngIf="appState !== 'config'">
        <span *ngIf="appState === 'running'">
          {{currentOperationString}}
        </span>
        <input
          *ngIf="appState === 'enter_answer' || appState === 'answered'"
          type="text"
          maxlength="3"
          (keypress)="isNumberInput($event)"
          (keyup.enter)="onAnswerInput()"
          fxFlex="none"
          class="my-input enter-answer-input"
          #answerInput
          autofocus
        >
      </div>

      <button
        *ngIf="appState === 'enter_answer'"
        class="enter-answer-button button"
        (click)="onAnswerInput()"
        type="button"
      >
        Ответить
      </button>
      <span *ngIf="appState === 'answered'" fxLayoutGap="1em">
        <button type="button" class="button" (click)="onRetry()">
          Еще раз
        </button>
        <button type="button" class="button" (click)="onClear()">
          Очистить
        </button>
      </span>
      <div class="past-operations" *ngIf="appState !== 'config'" #pastOperationsBlock>
        <span
          *ngFor="let operation of pastOperations"
          class="past-operation"
        >
          {{operationToString(operation)}}
        </span>
        &nbsp;
      </div>
    </div>
  </section>
  <section class="section" [class.not-in-focus]="appState !== 'config'" fxFlex="none">
    <header>
      <h1 class="section-header-text">УСТАНОВКА ПАРАМЕТРОВ</h1>
    </header>
    <div class="params" fxLayout="column">
      <div class="params-digits" fxLayout="row" fxLayoutAlign="start center">
        Разряды:
        &nbsp;
        <i class="material-icons params-digits-icon" (click)="setDigitsCnt(1)" title="Однозначные">
          {{configForm.value['digitsCnt'] >= 1 ? 'star' : 'star_border'}}
        </i>
        <i
          class="material-icons params-digits-icon" (click)="setDigitsCnt(2)" title="Двузначные">
          {{configForm.value['digitsCnt'] >= 2 ? 'star' : 'star_border'}}
        </i>
        <i class="material-icons params-digits-icon" (click)="setDigitsCnt(3)" title="Трехзначные">
          {{configForm.value['digitsCnt'] >= 3 ? 'star' : 'star_border'}}
        </i>
      </div>
      <div class="params-speed">
        Скорость:
        <input
          id="speed"
          class="my-input"
          type="number"
          list="speedValues" 
          step="0.1"
          min="0.3"
          max="7"
          [formControl]="configForm.get('speed')"
          required
        >
        &nbsp;c.
        <datalist id="speedValues">
          <option *ngFor="let opt of speedValues" [value]="opt">
        </datalist>
      </div>
      <div class="operations-cnt">
        Количество действий:
        <input
          class="my-input"
          required
          type="number"
          min="3"
          max="100"
          [formControl]="configForm.get('operationsCnt')"
        >
      </div>
      <button
        type="button"
        (click)="onStart()"
        [disabled]="!configForm.valid"
        class="button start-button"
        *ngIf="appState === 'config'"
      >
        Начать
      </button>
    </div>
  </section>
</main>
<footer class="bottom-section" fxLayout="row" fxLayoutAlign="space-around center">
  <span class="funny-digit" style="color:red">0</span>
  <span class="funny-digit" style="color:orange">1</span>
  <span class="funny-digit" style="color:brown">2</span>
  <span class="funny-digit" style="color:green">3</span>
  <span class="funny-digit" style="color:blue">4</span>
  <span class="funny-digit" style="color:darkblue">5</span>
  <span class="funny-digit" style="color:purple">6</span>
  <span class="funny-digit" style="color:brown">7</span>
  <span class="funny-digit" style="color:blue">8</span>
  <span class="funny-digit" style="color:red">9</span>
</footer>